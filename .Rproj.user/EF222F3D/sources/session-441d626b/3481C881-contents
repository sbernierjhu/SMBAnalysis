#Load CarPuchase.csv data
car <- read.csv("Data/CarPurchase.csv", na.strings = "", stringsAsFactors = FALSE)

#Explore dataset
str(car)
tail(car)
anyNA(car)
summary(car)
colnames(car)

#using diplyr method of renaming a column
car <- dplyr::rename(car, engine = engine.size...type)

#load tidyr
library(tidyr)
#separate columns
car <- separate(car, engine, c("size", "cyl"), sep = "L")
#further separate
car <- separate(car, cyl, c("cyl", "hybrid"), sep = "-", fill = "right")

car <- gather(car, key = Gender, value = PurchaseNo, "male":"female")

car$PurchaseNo[is.na(car$PurchaseNo)] <- 0

library(dplyr)
car <- mutate(car, hybrid = case_when(
  is.na(hybrid) ~ "No",
  hybrid == "Hybrid" ~ "Yes",
  TRUE ~ "NA"
))

write.csv(car, "Data/Better_CarPurchase.csv", row.names = FALSE)
